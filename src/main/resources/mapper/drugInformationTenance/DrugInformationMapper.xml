<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gxa.mapper.drugManagement.drugInformationTenance.DrugInformationMapper">
<!--查询所有
        查询部分数据的部分字段映射-->
    <resultMap id="queryList" type="com.gxa.entity.drugManagement.drugInformationTenance.DrugBasicInformation">
        <id column="id" property="id"/>
        <result column="code" property="code"/>
        <result column="drug_name" property="commonNameDrug"/>
        <result column="specs" property="drugSpecifications"/>
        <result column="drug_type" property="drugType"/>
        <result column="purchase_price" property="purchasePrice"/>
        <result column="sales_price" property="salesPrice"/>
        <result column="manufacturer" property="manufacturer"/>
        <result column="status" property="status"/>
        <result column="create_time" property="createTime"/>
    </resultMap>
    <!--药品管理信息主页,仅查询部分数据-->
    <select id="queryList" resultMap="queryList">
        select `id`,`code`,`drug_name`,`specs`,`drug_type`,`purchase_price`,`sales_price`,`manufacturer`,`status`,`create_time`
        from `drugManagement_drugInformationTenance_drugBasicInformation`;
    </select>
<!--根据id查询状态    -->
    <resultMap id="queryStatus" type="com.gxa.entity.drugManagement.drugInformationTenance.DrugBasicInformation">
        <id property="id" column="id"/>
        <result property="status" column="status"/>
    </resultMap>
    <select id="queryStatusById" resultMap="queryStatus">
        select `id`,`status` from `drugManagement_drugInformationTenance_drugBasicInformation`
    </select>
    <!--根据传入的id与value更新状态    -->
    <update id="updateStatus">
        update `drugManagement_drugInformationTenance_drugBasicInformation`
        set `status`=#{status}
        where id = #{id}
    </update>
    <select id="search" resultMap="queryList">
        select `id`,`code`,`drug_name`,`specs`,`drug_type`,`purchase_price`,`sales_price`,`manufacturer`,`status`,`create_time`
        from `drugManagement_drugInformationTenance_drugBasicInformation`
        <trim prefix="where" prefixOverrides="and|or" suffixOverrides="and|or">
            <if test="prescriptionCategory != null and prescriptionCategory !=''">
                drug_type = #{prescriptionCategory} and
            </if>
            <if test="status != null and status !=''">
                status = #{start} and
            </if>

        </trim>
        <trim prefix="(" suffix=")">
            <if test="(start != null and start !='') or (end =null and end ='')">
                create_time between #{start} and #{end}
            </if>
            <if test="rules != null and rules !=''">
                drug_name = concat('%',#{rules},'%') or
            </if>
        </trim>
    </select>

</mapper>