<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gxa.mapper.systemSettings.EmployeeManagementMapper">
    <resultMap id="ResultMap" type="EMEmployeeTable">
        <id property="id" column="id"></id>
        <result property="workNumber" column="user_name"></result>
        <result property="name" column="name"></result>
        <result property="sex" column="sex"></result>
        <result property="age" column="age"></result>
        <result property="phoneNumber" column="phone_num"></result>
        <result property="creationTime" column="creation_time"></result>
        <result property="createPerson" column="create_person"></result>
        <result property="employeeStatus" column="status"/>
        <result property="clinic" column="cn"/>
        <collection property="role" ofType="role" >
            <result property="name" column="rn"></result>
        </collection>
    </resultMap>
    <insert id="insert">
        insert into user (name,age,sex,phone_num,email,id_num,position,address,pwd,status,user_name,user_id)
        values(#{name},#{age},#{sex},#{phoneNumber},#{letterBox},#{idNumber},#{position},#{address},#{password},#{employeeStatus},#{workNumber},1)
    </insert>

    <insert id="insert1">
        insert into user (name,age,sex,phone_num,email,id_num,position,address,pwd,status,user_name,user_id)
        values(#{name},#{age},#{sex},#{phoneNumber},#{letterBox},#{idNumber},#{position},#{address},#{password},#{employeeStatus},#{workNumber},2)
    </insert>

    <insert id="insert2">
        insert into user (name,age,sex,phone_num,email,id_num,position,address,pwd,status,user_name,user_id)
        values(#{name},#{age},#{sex},#{phoneNumber},#{letterBox},#{idNumber},#{position},#{address},#{password},#{employeeStatus},#{workNumber},3)
    </insert>

    <update id="update">
        update user u,user_role ur
        set u.user_name=#{workNumber},u.name=#{name},u.age=#{age},u.sex=#{sex},u.phone_num=#{phoneNumber},u.email=#{letterBox},u.id_num=#{idNumber},u.position=#{position},u.address=#{address},ur.role_id=10,u.pwd=#{password},u.status=#{employeeStatus}

        where ur.user_id = u.id and ur.role_id = r.id and u.id=#{id}
    </update>

<!--    <delete id="update3">-->
<!--        delete from user_role ur-->
<!--        where ur.user_id = u.id and ur.role_id = r.id and u.id=#{id}-->
<!--    </delete>-->

    <update id="update1">
        update user u,user_role ur
        set u.user_name=#{workNumber},u.name=#{name},u.age=#{age},u.sex=#{sex},u.phone_num=#{phoneNumber},u.email=#{letterBox},u.id_num=#{idNumber},u.position=#{position},u.address=#{address},ur.role_id=20,u.pwd=#{password},u.status=#{employeeStatus}

        where ur.user_id = u.id and ur.role_id = r.id and u.id=#{id}
    </update>

    <update id="update2">
        update user u,user_role ur
        set u.user_name=#{workNumber},u.name=#{name},u.age=#{age},u.sex=#{sex},u.phone_num=#{phoneNumber},u.email=#{letterBox},u.id_num=#{idNumber},u.position=#{position},u.address=#{address},ur.role_id=30,u.pwd=#{password},u.status=#{employeeStatus}

        where ur.user_id = u.id and ur.role_id = r.id and u.id=#{id}
    </update>

<!--    <select id="selectAll" resultMap="ResultMap">-->
<!--        select u.id,u.user_name,u.name,u.sex,u.age,u.phone_num,u.creation_time,u.create_person,u.status,c.clinic_name-->
<!--        from user u,clinic_information c-->
<!--        where u.clinic_id = c.clinic_no-->
<!--    </select>-->

<!--    <select id="selectAll1" resultMap="ResultMap">-->
<!--        select r.name-->
<!--        from user u,user_role ur,role r-->
<!--        where ur.user_id = u.id and ur.role_id = r.id-->
<!--    </select>-->
<!--    <select id="selectA" resultType="com.gxa.entity.systemSettings.Role">-->
<!--        select r.name-->
<!--        from user u,user_role ur,role r-->
<!--        where ur.user_id = u.id and ur.role_id = r.id-->
<!--    </select>-->

        <select id="selectAll" resultMap="ResultMap">
        select u.id,u.user_name,u.name,u.sex,u.age,u.phone_num,r.name as rn,u.creation_time,u.create_person,u.status,c.clinic_name as cn
        from user u,clinic_information c,user_role ur,role r
        where u.clinic_id = c.clinic_no and ur.user_id = u.id and ur.role_id = r.id
    </select>

</mapper>